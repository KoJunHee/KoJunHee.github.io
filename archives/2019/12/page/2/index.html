
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="junhee.ko">
    <title>Archives: 2019/12 - junhee.ko</title>
    <meta name="author" content="junhee.ko">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta name="description" content="always learning">
<meta property="og:type" content="blog">
<meta property="og:title" content="junhee.ko">
<meta property="og:url" content="https://kojunhee.github.io/archives/2019/12/page/2/index.html">
<meta property="og:site_name" content="junhee.ko">
<meta property="og:description" content="always learning">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="junhee.ko">
<meta name="twitter:description" content="always learning">
    
    
        
    
    
        <meta property="og:image" content="https://kojunhee.github.io/assets/images/profile.jpg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/all.css">
    <link rel="stylesheet" href="/assets/css/jquery.fancybox.css">
    <link rel="stylesheet" href="/assets/css/thumbs.css">
    <link rel="stylesheet" href="/assets/css/tranquilpeak.css">
    <!--STYLES END-->
    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">junhee.ko</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="/assets/images/profile.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/profile.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">junhee.ko</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Always Learning</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="Categories"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archives"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/kojunhee" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://facebook.com/kojunheee" target="_blank" rel="noopener" title="Facebook">
                    
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://www.linkedin.com/in/junheeko" target="_blank" rel="noopener" title="LinkedIn">
                    
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="mailto:junheee.ko@gmail.com" target="_blank" rel="noopener" title="Mail">
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2019/12/10/object-chapter8/">
                            [오브젝트] 8장_의존성 관리하기
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-12-10T00:00:00+09:00">
	
		    Dec 10, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/object/">Object</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>이번장에서는 충분히 협력적이고 유연한 객체를 만들기 위해, 의존성을 관리하는 방법을 정리한다.</p>
<h2 id="01-의존성-이해하기"><a href="#01-의존성-이해하기" class="headerlink" title="01 의존성 이해하기"></a>01 의존성 이해하기</h2><h5 id="변경과-의존성"><a href="#변경과-의존성" class="headerlink" title="변경과 의존성"></a>변경과 의존성</h5><p>어떤 객체가 협력을 위해 다른 객체가 필요할 때, 두 객체 사이의 의존성이 존재한다. </p>
<p>아래 코드에서, 어떤 형태로든 DayOfWeek, LocalTime, Screening, DiscountCondition 이 변경되면 PeriodCondition 도 함께 변경될 수 있다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PeriodCondition</span> <span class="keyword">implements</span> <span class="title">DiscountCondition</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> DayOfWeek dayOfWeek;</span><br><span class="line">  <span class="keyword">private</span> LocalTime startTime;</span><br><span class="line">  <span class="keyword">private</span> LocalTime endTime;</span><br><span class="line">  ...</span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSatisfiedBy</span><span class="params">(Screening screening)</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="의존성-전이"><a href="#의존성-전이" class="headerlink" title="의존성 전이"></a>의존성 전이</h5><p><img src="/image/object_dependency.png" alt></p>
<p>PeriodCondition 이 Screening 에 의존하면, PeriodCondition 은 Screening 이 의존하는 대상에 대해서도 의존하게 된다는 것이다.</p>
<p>의존성이 실제로 전이 될지 여부는 변경의 방향과 캡슐화의 정도에 따라 다르다. Screening 이 내부 구현을 효과적으로 캡슐화하면 Screening 에 의존하고 있는 PeriodCondition 까지는 변경이 전파되지 않는다.</p>
<p>의존성의 종류는,</p>
<ol>
<li><p>직접 의존성</p>
<p>한 요소가 다른 요소에 직접 의존하는 경우. PeriodCondition 이 Screening 에 의존</p>
</li>
<li><p>간접 의존성</p>
<p>의존성 전이에 의해 영향이 전파되는 경우</p>
</li>
</ol>
<h5 id="런타임-의존성과-컴파일타임-의존성"><a href="#런타임-의존성과-컴파일타임-의존성" class="headerlink" title="런타임 의존성과 컴파일타임 의존성"></a>런타임 의존성과 컴파일타임 의존성</h5><ol>
<li><p>런타임</p>
<p>애플리케이션이 실행되는 시점</p>
</li>
<li><p>컴파일 타임</p>
<p>작성된 코드를 컴파일 하는 시점. 문맥에 따라서는, 코드 그 자체</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Movie</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">    <span class="keyword">private</span> DiscountPolicy discountPolicy;</span><br><span class="line">  	</span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="title">Movie</span><span class="params">(String title, ... , DiscountPolicy discountPolicy)</span></span>&#123;</span><br><span class="line">      ...</span><br><span class="line">      <span class="keyword">this</span>.discountPolicy = discountPolicy;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">  	<span class="function"><span class="keyword">public</span> Money <span class="title">calcuateMovieFee</span><span class="params">(Screening screening)</span></span>&#123;</span><br><span class="line">      <span class="keyword">return</span> fee.minus(discountPolicy.caculateDiscountAmount(screening));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>코드를 작성하는 시점에서 Movie 클래스는 AmountDiscountPolicy 클래스와 PercentDiscountPolicy 의 존재를 모르지만, 실행 시점의 Movie 인스턴스는  AmountDiscountPolicy 인스턴스와 PercentDiscountPolicy 인스턴스와 협력할 수 있어야한다.</p>
<p>협력할 인스턴스의 구체적인 클래스를 알면 안된다. 실제로 협력할 객체가 어떤 것인지는 런타임에 해결해야한다.</p>
<p>핵심 : 유연하고 재사용 가능한 설계를 만들기 위해서는 동일한 소스 코드 구조로 다양한 실행 구조를 만들 수 있어야한다.</p>
<h5 id="컨텍스트-독립성"><a href="#컨텍스트-독립성" class="headerlink" title="컨텍스트 독립성"></a>컨텍스트 독립성</h5><p>클래스가 특정 문맥에 강하게 결합되면 다른 문맥에서 사용하기 어렵다. 클래스가 사용될 특정 문맥에 대해 최소한의 가정으로만 이뤄져 있다면 다른 문맥에서 사용하기 쉽다. 이것이 컨텍스트 독립성이다.</p>
<h5 id="의존성-해결하기"><a href="#의존성-해결하기" class="headerlink" title="의존성 해결하기"></a>의존성 해결하기</h5><p>의존성 해결이란, 컴파일 타임 의존성을 실행 컨텍스트에 맞는 적절한 런타임 의존성으로 교체하는 것이다.</p>
<p>해결 방법으로,</p>
<ol>
<li><p>객체 생성 시점에, 생성자로 의존성 해결</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Movie avater = <span class="keyword">new</span> Movie(<span class="string">"아바타"</span>, <span class="keyword">new</span> AmountDiscountPolicy(...), ....);</span><br></pre></td></tr></table></figure>
</li>
<li><p>객체 생성 후, setter 메서드를 통해 의존성 해결</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Movie avater = <span class="keyword">new</span> Movie(...);</span><br><span class="line">avater.setDiscountPolicy(<span class="keyword">new</span> AmountDiscountPolicy(...));</span><br></pre></td></tr></table></figure>

<p>장점은, 실행 시점에 대상을 변경할수 있어서 설계가 유연하다.</p>
<p>단점은, 객체를 생성하고 의존 대상 설정 전까지는 객체의 상태가 불완전할 수 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Movie avater = <span class="keyword">new</span> Movie(...);</span><br><span class="line">avatar.calculatFee(...); <span class="comment">//NPE 예외 발생</span></span><br><span class="line">avater.setDiscountPolicy(<span class="keyword">new</span> AmountDiscountPolicy(...));</span><br></pre></td></tr></table></figure>
</li>
<li><p>생성자 방식과 setter 방식 혼합</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Movie avater = <span class="keyword">new</span> Movie(<span class="string">"아바타"</span>, <span class="keyword">new</span> AmountDiscountPolicy(...), ....);</span><br><span class="line">avater.setDiscountPolicy(<span class="keyword">new</span> PercentDiscountPolicy(...));</span><br></pre></td></tr></table></figure>
</li>
<li><p>메서드 실행 시 인자를 이용해 의존성 해결</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Movie</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Money <span class="title">calulateMovieFee</span><span class="params">(Screening screening, DiscountPolicy discoutPolicy)</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>협력 대상에 지속적으로 의존 관계 맺을 필요 없이, 메서드가 실행되는 동안 일시적으로 의존관계가 존재해도 되거나, 메서드 실행 시점에 매번 의존 대상이 변경되는 경우 유용하다.</p>
</li>
</ol>
<h2 id="02-유연한-설계"><a href="#02-유연한-설계" class="headerlink" title="02 유연한 설계"></a>02 유연한 설계</h2><h5 id="의존성과-결합도"><a href="#의존성과-결합도" class="headerlink" title="의존성과 결합도"></a>의존성과 결합도</h5><p>바람직한 의존성이란, </p>
<ol>
<li>컨텍스트에 독립적이고 다양한 환경에서 재사용될 수 있는 가능성을 열어놓은 것이다.</li>
<li>loose coupling, weak coupling</li>
</ol>
<h5 id="지식이-결합을-낳는다"><a href="#지식이-결합을-낳는다" class="headerlink" title="지식이 결합을 낳는다."></a>지식이 결합을 낳는다.</h5><p>한 요소가 다른 요소에 대해 많은 정보를 알면 알수록, 두 요소는 강하게 결합된다.</p>
<ol>
<li><p>Movie 클래스가 PercentDiscountPolicy 에 직접 의존하면, Movie 는 협력할 객체가 비율 할인 정책에 따라 할인 요금을 계산할 것이라는 걸 알아야 한다.</p>
</li>
<li><p>Movie 클래스가 추상 클래스인 DiscoutPolicy 에 의존하면, 구체적인 계산 방법은 알 필요 없이 할잉ㄴ 요금을 계산한다는 사실만 알면 된다.</p>
</li>
</ol>
<p>결합도를 느슨하게 만들기 위해선, 협력 대상에 대해 필요한 정보 외에는 최대한 감추어야한다. 방법은 추상화이다.</p>
<h5 id="추상화에-의존하라"><a href="#추상화에-의존하라" class="headerlink" title="추상화에 의존하라"></a>추상화에 의존하라</h5><p>의존하는 대상이 추상적일 수록, 결합도는더 낮아진다.</p>
<p>아래로 갈수록, 클라이언트가 알아야하는 지식의 양이 적어져 결합도가 느슨해진다.</p>
<ul>
<li>구체 클래스 의존성</li>
<li>추상 클래스 의존성</li>
<li>인터페이스 의존성</li>
</ul>
<p>구체 클래스에 비해, 추상 클래스는 메서드의 내부 구현과 자식 클래스의 종류에 대한 지식을 클라이언트에게 숨길 수 있다.</p>
<p>추상 클래스에 비해, 인터페이스는 상속 계층을 모르더라도 협력이 가능하다.</p>
<h5 id="명시적인-의존성"><a href="#명시적인-의존성" class="headerlink" title="명시적인 의존성"></a>명시적인 의존성</h5><p>“숨겨진 의존성을 밝은 곳으로 드러내서 널리 알리자”</p>
<ol>
<li>숨겨진 의존성</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Movie</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">    <span class="keyword">private</span> DiscountPolicy discountPolicy;</span><br><span class="line">  	</span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="title">Movie</span><span class="params">(String title, ...)</span></span>&#123;</span><br><span class="line">      ...</span><br><span class="line">      <span class="keyword">this</span>.discountPolicy = <span class="keyword">new</span> AmountDiscountPolicy(...);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>위 코드는, 생성자에서 구체 클래스인 AmountDiscountPolicy 의 인스턴스를 직접 생성해서 대입하고 있다. Movie 는 추상 클래스인 DiscountPolicy 뿐만 아니라, AmountDiscountPolicy 에도 의존하고 있다. </p>
<p>Movie 가 DiscountPolicy 에 의존하고 있다는 것을 감춘다. 이것이 숨겨진 의존성이다.</p>
<p>의존성 파악을 위해 내부 구현을 직접 살펴봐야한다. 그리고, 의존성이 명시적이지 않으면 클래스를 다른 컨텍스트에서 재사용하기 위해 내부 구현을 직접 변경해야한다.</p>
<ol start="2">
<li>명시적인 의존성</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Movie</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">    <span class="keyword">private</span> DiscountPolicy discountPolicy;</span><br><span class="line">  	</span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="title">Movie</span><span class="params">(String title, ... , DiscountPolicy discountPolicy)</span></span>&#123;</span><br><span class="line">      ...</span><br><span class="line">      <span class="keyword">this</span>.discountPolicy = discountPolicy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>위 코드는, 생성자 안에서 직접 인스턴스를 생성하지 않고 생성자의 인자로 선언한다. </p>
<p>Movie 가 DiscountPolicy에 의존하고 있다는 것을 Movie 의 퍼블릭 인터페이스로 드러내고 있다. 이것이 명시적인 의존성이다.</p>
<h5 id="new-는-해롭다"><a href="#new-는-해롭다" class="headerlink" title="new 는 해롭다"></a>new 는 해롭다</h5><p>결합도 측면헤서 해로운 이유는,</p>
<ol>
<li>new 연산자 사용 위해 구체 클래스의 이름을 직접 기술해야한다. 그래서, new 를 사용하는 클라이언트는 구체 클래스에 의존을 해서 결합도가 높아진다.</li>
<li>구체 클래스의 어떤 인자를 사용해서 클래스의 생성자를 호출해야하는지도 알아야한다. 그래서, 클라이언트가 알아야하는 지식의 양이 늘어나 결합도가 높아진다.</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Movie</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">    <span class="keyword">private</span> DiscountPolicy discountPolicy;</span><br><span class="line">  	</span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="title">Movie</span><span class="params">(String title, ... )</span></span>&#123;</span><br><span class="line">      ...</span><br><span class="line">      <span class="keyword">this</span>.discountPolicy = <span class="keyword">new</span> AmountDiscountPolicy(....)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>AmountDiscountPolicy 인스턴스 생성을 위해, 생성자에 전달해야하는 인자를 알아야한다.</p>
<p>해결방법은, 인스턴스 생성 로직과 사용 로직을 분리한다. 즉, Movie 는 외부로부터 이미 생성된 AmountDiscountPolicy 의 인스턴스를 전달받아야한다.</p>
<p>외부에서 인스턴스를 전달받는 방법은,</p>
<ol>
<li>생성자의 인자</li>
<li>setter 메서드</li>
<li>메서드의 인자</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Movie</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">    <span class="keyword">private</span> DiscountPolicy discountPolicy;</span><br><span class="line">  	</span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="title">Movie</span><span class="params">(String title, ... , DiscountPolicy discountPolicy)</span></span>&#123;</span><br><span class="line">      ...</span><br><span class="line">      <span class="keyword">this</span>.discountPolicy = discountPolicy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>AmountDiscountPolicy 생성 책임은 Movie 의 클라이언트로 옮겨지고, Movie 는 AmountDiscountPolicy 인스턴스를 사용하는 책임만 남는다.</p>
<h5 id="가끔은-생성해도-무방하다"><a href="#가끔은-생성해도-무방하다" class="headerlink" title="가끔은 생성해도 무방하다"></a>가끔은 생성해도 무방하다</h5><p>주로 협력하는 기본 객체를 설정하고 싶으면 가끔은 생성해도 무방하다.</p>
<p>설계는 트레이드오프다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Movie</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">    <span class="keyword">private</span> DiscountPolicy discountPolicy;</span><br><span class="line">  </span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="title">Movie</span><span class="params">(String title, ... )</span></span>&#123;</span><br><span class="line">			<span class="keyword">this</span>(title, ..., <span class="keyword">new</span> AmountDiscountPlicy(...));</span><br><span class="line">    &#125;</span><br><span class="line">  	</span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="title">Movie</span><span class="params">(String title, ... , DiscountPolicy discountPolicy)</span></span>&#123;</span><br><span class="line">      ...</span><br><span class="line">      <span class="keyword">this</span>.discountPolicy = discountPolicy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="표준-클래스에-대한-의존은-해롭지-않다"><a href="#표준-클래스에-대한-의존은-해롭지-않다" class="headerlink" title="표준 클래스에 대한 의존은 해롭지 않다"></a>표준 클래스에 대한 의존은 해롭지 않다</h5><p>변경될 확률이 거의 없으면, 의존성이 문제가 되지 않는다. </p>
<p>ex) JDK 에 포함된 표준 클래스</p>
<h5 id="컨텍스트-확장하기"><a href="#컨텍스트-확장하기" class="headerlink" title="컨텍스트 확장하기"></a>컨텍스트 확장하기</h5><ol>
<li><p>NoneDiscountPolicy</p>
<p>할인 정책이 존재 하지 않는다는 사실을 할인 정책의 한 종류로 간주</p>
</li>
<li><p>OverlappedDiscountPolicy</p>
<p>중복 할인 정책을 표현하기 위함</p>
</li>
</ol>
<p>설계를 유연하게 할 수 있었던 이유는,</p>
<ol>
<li>DiscountPolicy 라는 추상화에 의존</li>
<li>생성자를 통해 DiscountPolicy 에 대한 의존성을 명시적으로 드러냄</li>
<li>new 와 같이 구체 클래스를 직접 다뤄야하는 책임을 Movie 외부로 옮김</li>
</ol>
<h5 id="조합-가능한-행동"><a href="#조합-가능한-행동" class="headerlink" title="조합 가능한 행동"></a>조합 가능한 행동</h5><p>훌륭한 객체 지향 설계는, 어떻게 하는지 표현하는 것이 아니라 객체들의 조합을 선언적으로 표현해서 객체들이 무엇을 하는지 표현하는 설계다.</p>

                    
                        

                    
                    
                        <p>
                            <a href="/2019/12/10/object-chapter8/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2019/12/02/object-chapter7/">
                            [오브젝트] 7장_객체 분해
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-12-02T00:00:00+09:00">
	
		    Dec 02, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/object/">Object</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>하향식 기능 분해 -&gt; 모듈 -&gt; 추상 데이터 타입 -&gt; 클래스</p>
<h2 id="01-프로시저-추상화와-데이터-추상화"><a href="#01-프로시저-추상화와-데이터-추상화" class="headerlink" title="01 프로시저 추상화와 데이터 추상화"></a>01 프로시저 추상화와 데이터 추상화</h2><ul>
<li>데이터 추상화<ul>
<li>추상 데이터 타입 : 데이터 중심으로 타입을 추상화</li>
<li>객체지향 : 데이터 중심으로 프로시저를 추상화</li>
</ul>
</li>
</ul>
<h2 id="02-프로시저-추상화와-기능-분해"><a href="#02-프로시저-추상화와-기능-분해" class="headerlink" title="02 프로시저 추상화와 기능 분해"></a>02 프로시저 추상화와 기능 분해</h2><h5 id="메인-함수로서의-시스템"><a href="#메인-함수로서의-시스템" class="headerlink" title="메인 함수로서의 시스템"></a>메인 함수로서의 시스템</h5><p>전통적인 기능 분해방법은 하향식 접근법이다. 즉, 최상위 기능을 좀 더 작은 단계의 하위 기능으로 분해해 나가는 방법이다.</p>
<h5 id="급여-관리-시스템"><a href="#급여-관리-시스템" class="headerlink" title="급여 관리 시스템"></a>급여 관리 시스템</h5><p>모든 문장이 정제 과정을 거치면서 하나 이상의 좀 더 단순하고 구체적인 문장들의 조합으로 분해된다.</p>
<ul>
<li>직원의 급여를 계산한다<ul>
<li>사용자에게 소득세율을 입력 받는다<ul>
<li>“세율을 입력하세요 : “ 라는 문장을 화면에 출력한다</li>
<li>…</li>
</ul>
</li>
<li>직원의 급여를 계산한다<ul>
<li>전역 변수에 저장된 직원의 기본접 정보를 얻는다</li>
<li>…</li>
</ul>
</li>
<li>양식에 맞게 출력한다<ul>
<li>…</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="급여-관리-시스템-구현"><a href="#급여-관리-시스템-구현" class="headerlink" title="급여 관리 시스템 구현"></a>급여 관리 시스템 구현</h5><p>하향식 기능 분해로, 시스템을 최상위의 가장 추상적인 메인함수로 정의하고 메인함수를 구현 가능한 수준까지 세부적인 단계로 분해한다. 메인함수를 루트로 하는 ‘트리’ 로 표현할 수 있다.</p>
<h5 id="하향식-기능-분해의-문제점"><a href="#하향식-기능-분해의-문제점" class="headerlink" title="하향식 기능 분해의 문제점"></a>하향식 기능 분해의 문제점</h5><ul>
<li>하나의 메인 함수라는 비현실적 아이디어<ul>
<li>새로운 요구사항이 나오면 지속적으로 새로운 기능을 추가한다. 이것은 시스템이 오직 하나의 메인 함수로 구현된다는 개념과 모순된다.</li>
</ul>
</li>
<li>메인 함수의 빈번한 재설계<ul>
<li>새로운 기능을 추가할 때마다 매번 메인 함수를 수정해야한다.</li>
</ul>
</li>
<li>비즈니스 로직과 사용자 인터페이스 결합<ul>
<li>사용자 인터페이스는 시스템에서 자주 변경되는 부분이다. 비즈니스 로직은 변경이 적게 발생한다. 하향식 접근 방법은 인터페이스와 비즈니스 로직을 섞기 때문에 사용자 인터페이스를 변경하는 경우 비즈니스 로직까지 변경에 영향을 받는다.</li>
</ul>
</li>
<li>성급하게 결정된 실행 순서<ul>
<li>함수들의 실행순서를 정의하는 시간 제약을 강조한다. 메인 함수가 작은 함수들로 분해되기 위해서는 우선 함수들의 순서를 결정해야한다. 문제는, 함수의 제어 구조가 빈번한 변경의 대상이라는 점이다. </li>
</ul>
</li>
<li>분해된 함수들은 재사용이 어렵다<ul>
<li>모든 함수는 상위 함수를 분해하는 과정에서 필요에 따라 식별되며, 그에 따라 상위 함수가 강요하는 문맥 안에서만 의미를 가지기 때문이다</li>
</ul>
</li>
<li>데이터 변경으로 인한 파급 효과<ul>
<li>어떤 데이터를 어떤 함수가 사용하고 있는지 추적이 어렵다. 그래서, 데이터 변경으로 인해 어떤 함수가 영향 받을지 예상이 어렵다</li>
</ul>
</li>
</ul>
<h5 id="언제-하향식-분해가-유용한가"><a href="#언제-하향식-분해가-유용한가" class="headerlink" title="언제 하향식 분해가 유용한가 ?"></a>언제 하향식 분해가 유용한가 ?</h5><p>이미 해결된 알고리즘을 문서화하고 서술하는데 훌륭한 기법이다. </p>
<h2 id="03-모듈"><a href="#03-모듈" class="headerlink" title="03 모듈"></a>03 모듈</h2><h5 id="정보-은닉과-모듈"><a href="#정보-은닉과-모듈" class="headerlink" title="정보 은닉과 모듈"></a>정보 은닉과 모듈</h5><p>변경을 관리하는 기본 적략은, 함꼐 변경되는 부분을 하나의 구현 단위로 묶고 퍼블릭 인터페이스를 통해서만 접근하도록 만드는 것이다. </p>
<p>정보 은닉은, 시스템에서 자주 변경되는 부분을 덜 변경되는 안정적인 인터페이스 뒤로 감춰야한다는 것이 핵심이다.</p>
<p>모듈은 다음 두가지를 감춰야한다.</p>
<ol>
<li><p>복잡성</p>
<p>외부에 모듈을 추상화 할 수 있는 간단한 인터페이스를 제공해서 모듈의 복잡도를 낮춘다.</p>
</li>
<li><p>변경 가능성</p>
<p>변경 발생히, 하나의 모듈만 수정하면 되도록 변경 가능한 설계 과정을 모듈 내부로 감추고 외부에는 쉽게 견경되지 않을 인터페이스를 제공한다.</p>
</li>
</ol>
<h5 id="모듈의-장점과-한계"><a href="#모듈의-장점과-한계" class="headerlink" title="모듈의 장점과 한계"></a>모듈의 장점과 한계</h5><p>모듈은 외부에 감춰야 하는 비밀과 관련성 높은 데이터와 함수의 집합이다. 따라서, 모듈 내부는 높은 응집도를 유지한다.</p>
<p>모듈과 모듈 사이에는 퍼블릭 인터페이스를 통해서만 통신한다. 따라서, 낮은 결합도를 유지한다.</p>
<p>모듈의 장점은,</p>
<ol>
<li>모듈 내부의 변수가 변경되더라도 모듈 내부에만 영향을 받는다</li>
<li>비즈니스 로직과 사용자 인터페이스에 대한 관심사를 분리한다</li>
<li>전역변수와 전역 함수를 제거해서, 네임스페이스 오염을 방지하고 이름 충돌의 위험을 완화한다.</li>
</ol>
<p>모듈의 단점은,</p>
<ol>
<li>인스턴스 개념을 제공하지 않는다. 높은 수준의 추상화를 위해서는 직원 전체가 아니라 개별 직원을 독립적인 단위로 다룰 수 있어야 한다. 이것이 추상 데이터 타입이다.</li>
</ol>
<h2 id="04-데이터-추상화와-추상-데이터-타입"><a href="#04-데이터-추상화와-추상-데이터-타입" class="headerlink" title="04 데이터 추상화와 추상 데이터 타입"></a>04 데이터 추상화와 추상 데이터 타입</h2><h5 id="추상-데이터-타입"><a href="#추상-데이터-타입" class="headerlink" title="추상 데이터 타입"></a>추상 데이터 타입</h5><p>개별 직원의 인스턴스를 생성할 수 있는 Employee 추상 데이터 타입은, 전체 직원을 캡슐화하는 Employees 모듈 보다 더 개념적으로 사람들의 사고방식의 가깝다.</p>
<p>추상 데이터 타입을 구현하기 위해, 프로그래밍 언어는 다음 지원이 필요하다.</p>
<ol>
<li>타입 정의 선언 가능해야함</li>
<li>타입의 인스턴스를 다루기 위해, 오퍼레이션의 집합을 정의할 수 있어야함</li>
<li>제공된 오퍼레이션을 통해서만 조작할 수 있도록 데이터를 외부로부터 보호 할 수 있어야함</li>
<li>타입에 대해 여러개의 인스턴스를 생성할 수 있어야함</li>
</ol>
<h2 id="05-클래스"><a href="#05-클래스" class="headerlink" title="05 클래스"></a>05 클래스</h2><h5 id="클래스는-추상-데이터-타입인가"><a href="#클래스는-추상-데이터-타입인가" class="headerlink" title="클래스는 추상 데이터 타입인가 ?"></a>클래스는 추상 데이터 타입인가 ?</h5><p>동일하지 않다. 클래스는 상속과 다형성을 지원하는데, 추상데이터타입은 그렇지 않다.</p>
<p>추상 데이터 타입으로 구현된 Employee 타입을 보면, 하나의 타입처럼 보이는 Employee 내부에는 정규 직원과 아르바이트 직원이라는 두개의 타입이 공존한다. 하나의 대표적인 타입이 다수의 세부적인 타입을 감추기 때문에 이를, 타입 추상화 라고한다.</p>
<p>추상 데이터타입이 오퍼레이션을 기준으로 타입을 묶는 방법이라면, 객체지향은 타입을 기준으로 오퍼레이션을 묶는다. 객체지향은 정규 직원과 아르바이트 직원 각각에 대한 클래스를 정의하고 각 클래스들이 calculatePay 와 monthlyBasePay 오퍼레이션을 적절하게 구현한다.</p>
<p>정규 직원과 아르바이트 직원 두 가지 클래스로 분리하면, 공통 로직은 어디에 둘것인가 ? 공통 로직을 포함할 부모 클래스를 정의하고 두 직원 유형의 클래스가 부모 클래스를 상속 받으면 된다</p>
<h5 id="추상-데이터-타입에서-클래스로-변경하기"><a href="#추상-데이터-타입에서-클래스로-변경하기" class="headerlink" title="추상 데이터 타입에서 클래스로 변경하기"></a>추상 데이터 타입에서 클래스로 변경하기</h5><p>객체지향에서는, 각 직원의 타입을 독립적인 클래스로 구현한다. </p>
<h5 id="변경을-기준으로-선택하라"><a href="#변경을-기준으로-선택하라" class="headerlink" title="변경을 기준으로 선택하라"></a>변경을 기준으로 선택하라</h5><p>인스턴스 변수에 저장된 값을 기준으로 메서드 내에서 타입을 명시적으로 구분하는 방식은 객체지향을 위반한 것이다. 클래스가 추상 데이터 타입의 개념을 따른 것이다.</p>
<p>언제 추상 데이터 타입이, 객체 지향이 낫나 ?</p>
<ol>
<li><p>타입 추가라는 변경의 압력이 강하면, 객체 지향이 낫다. </p>
<p>추상 데이터 타입의 경우, 새로운 타입을 추가하면 타입 체크하는 클라이언트 코드를 모두 찾아 수정해야한다.</p>
</li>
<li><p>오퍼레이션 추가라는 변경의 압력이 강하면, 추상 데이터 타입이 낫다. </p>
<p>추상 데이터 타입은 전체 타입에 대한 구현 코드가 하나의 구현체 내에 포함돼서 새로운 오퍼레이션 추가가 간단한다.</p>
</li>
</ol>
<h5 id="협력이-중요하다"><a href="#협력이-중요하다" class="headerlink" title="협력이 중요하다"></a>협력이 중요하다</h5><p>객체지향의 핵심 : 역함, 책임, 협력</p>
<p>“객체가 참여할 협력을 결정하고, 협력에 필요한 책임을 수행하기 위해, 어떤 객체가 필요한지 고민하라”</p>

                    
                        

                    
                    
                        <p>
                            <a href="/2019/12/02/object-chapter7/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
          <li class="pagination-prev">
            <a class="btn btn--default btn--small" href="/archives/2019/12/">
              <i class="fa fa-angle-left text-base icon-mr"></i>
              <span>NEWER POSTS</span>
            </a>
          </li>
        
        
        <li class="pagination-number">page 2 of 2</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2019 junhee.ko. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/profile.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">junhee.ko</h4>
        
            <div id="about-card-bio"><p>Always Learning</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Engineer</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Incheon
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/jquery.fancybox.js"></script>
<script src="/assets/js/thumbs.js"></script>
<script src="/assets/js/tranquilpeak.js"></script>
<!--SCRIPTS END-->



    </body>
</html>
